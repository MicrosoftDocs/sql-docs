---
title: "Health Rules Reference (Power Pivot for SharePoint) | Microsoft Docs"
ms.date: 05/02/2018
ms.prod: sql
ms.technology: analysis-services
ms.custom: ppvt-sharepoint
ms.topic: conceptual
ms.author: owend
ms.reviewer: owend
author: minewiskan
manager: kfile
---
# Health Rules Reference (Power Pivot for SharePoint)
[!INCLUDE[ssas-appliesto-sqlas](../../includes/ssas-appliesto-sqlas.md)]
  This reference topic describes the SharePoint health rules that are added by a [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] for SharePoint installation. These rules are used to report problems with server health, availability, or configuration of a [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] service application or its associated [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance.  
  
 The following table lists the rules in the order in which they appear on the Health Analyzer Rule Definitions page in SharePoint Central Administration. Configurable rules are those for which you can change the thresholds at which the rule is triggered. For more information, see [Configure Power Pivot Health Rules](../../analysis-services/power-pivot-sharepoint/configure-power-pivot-health-rules.md). Auto Repair indicates that there is a built-in remedy that you can click from within the Problem reports page to resolve the issue.  
  
||  
|-|  
|**[!INCLUDE[applies](../../includes/applies-md.md)]**  SharePoint 2013 &#124; SharePoint 2010|  
  
 **Note:** [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installs different sets of health rules for different versions of SharePoint. See the "version" column in the table below, or you can run the following Windows PowerShell command to see the installed rules.  
  
```  
Get-SPHealthAnalysisRule | select name, enabled, summary | where {$_.summary -like "*power*"}  | format-table -property * -autosize | out-default  
```  
  
|Rule|Configurable|Auto Repair|Version|Description|  
|----------|------------------|-----------------|-------------|-----------------|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: The Analysis Services OLE DB provider is not installed on this computer.|No|No|SharePoint 2010|The Analysis Services OLE DB provider is either not installed on the server or it is the wrong version. This rule appears when your SharePoint farm includes instances of Excel Services on application servers that do not have [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] for SharePoint. The rule warns you that the Analysis Services OLE DB provider used by Excel Services to connect to [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] data is not installed. To resolve this issue, install the OLE DB provider on each Excel Services server that does not have the Analysis Services OLE DB provider. You can download and install the Analysis Services OLE DB provider from the Microsoft Download center. For more information, see [Install the Analysis Services OLE DB Provider on SharePoint Servers](http://msdn.microsoft.com/2c62daf9-1f2d-4508-a497-af62360ee859).|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: Registry settings for Microsoft.AnalysisServices.ChannelTransport.dll are not valid after you install the SQL Server 2008 R2 version of the MSOLAP provider on this computer.|No|Yes|SharePoint 2010|This is a server configuration issue. Most likely, the ChannelTransport.dll is not registered in the global assembly. Run the automatic repair for this rule to register the .dll on each server that has an installation of [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] for SharePoint. Alternatively, you can run regasm.exe manually to register the file. If the SharePoint timer service is not running as local administrator, manual registration might be required. Failure to update the registry settings results in slow server communication between Excel Services and [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] System Service, and can result in connection failures in certain security configurations.|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] service application does not have permission to complete operation.|No|No|SharePoint 2010|This rule checks whether the [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] service application identity is database owner of the [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] server application database and has administrative permissions on the local SQL Server Analysis Services instance. These permissions are granted automatically during installation and deployment, but if this step failed to complete, this health rule will occur.|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: The [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] service application identity should not be a member of the local Administrators group.|No|No|SharePoint 2010|This is a best practice that improves the overall security of your deployment. If you configured the [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] service application to run under an account that belongs to the local Administrator group, you should change the service account to one that does not belong to that group. The recommendation is to use a least-privileged, dedicated account for each service. Doing so provides service isolation and makes it easier to audit logins. For more information about changing the service account, see [Configure Power Pivot Service Accounts](../../analysis-services/power-pivot-sharepoint/configure-power-pivot-service-accounts.md).|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: The Analysis Services instance runs in Tabular mode, but the configuration setting that specifies this mode is turned off.|No|No|SharePoint 2010|This rule checks whether the SQL Server Analysis Services instance in a [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] for SharePoint installation has the **DeploymentMode** server property set to 1. If the property is set to another value, or if the SharePoint Timer service that runs the rule checker does not have permission to open the file, this rule will fail. For more information about the deployment mode property, see [Determine the Server Mode of an Analysis Services Instance](../../analysis-services/instances/determine-the-server-mode-of-an-analysis-services-instance.md).|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: The [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] Data Refresh Timer Job is disabled.|No|No|SharePoint 2013<br /><br /> SharePoint 2010|Check the timer job settings to verify the timer job is enabled. If you are not using the [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] data refresh feature, you can ignore this rule. For more information, see [Power Pivot Data Refresh with SharePoint 2010](http://msdn.microsoft.com/01b54e6f-66e5-485c-acaa-3f9aa53119c9).|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: The SQL Server Analysis Services ([!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]) service account information that is managed by the SQL Server Configuration Manager is different from the account information that is managed by Central Administration.|No|No|SharePoint 2010|This rule checks whether the service account information in SQL Server Configuration Manager is identical to the managed account information in Central Administration for the same Analysis Services instance. If the accounts are different, an entry is added to the Problem and Resolution report so that you can change the service account information in SQL Server Configuration Manager back to the account specified in Central Administration. SQL Server Configuration Manager is not a supported tool for changing a service account username or password in a [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] for SharePoint installation. Using Central Administration enables the use of the managed accounts feature in SharePoint. More importantly, if your farm includes multiple [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] for SharePoint servers, having inconsistent service account settings can disrupt processing and query operations on the server that has incorrect service information.<br /><br /> On a single server, [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] workbooks will function temporarily when this rule is triggered, but it is advised that you fix the problem as soon as possible. Database and file system permissions are updated using the account information specified in Central Administration.|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: The deployed farm solution is not up-to-date.|No|Yes|SharePoint 2010|A [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] for SharePoint installation uses a farm level solution and a web application level solution to install its features. This rule indicates that the farm solution is not current relative to the version or the server or possibly the web solution. Most likely, this is server deployment problem. To remedy this problem, consider running SQL Server Setup to repair one of the [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] for SharePoint installations in your farm. For more information about solutions in a [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] for SharePoint installation, see [Deploy Power Pivot Solutions to SharePoint](../../analysis-services/power-pivot-sharepoint/deploy-power-pivot-solutions-to-sharepoint.md).|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: Overall CPU usage is too high.|Yes|No|SharePoint 2010|This rule reports on CPU consumption at the system level. Overall CPU usage is monitored because the [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] System Service uses it as a measure of server health, for health-based load balancing among multiple [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] for SharePoint servers in a farm. Consider adding another application server to the farm, and moving CPU intensive applications to that server.|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: Analysis Services does not have sufficient CPU resources to perform requested operations.|Yes|No|SharePoint 2010|The amount of CPU resources available to the Analysis Services process (msmdsrv.exe) is not sufficient for the level of activity on this server. Consider adding another [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] for SharePoint server to the farm. For more information, see [Deployment Checklist: Scale-out by adding Power Pivot Servers to a SharePoint 2010 farm](http://msdn.microsoft.com/library/2dbddcc7-427a-4537-a8e2-56d99b9d967d).|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: Analysis Services does not have sufficient memory to perform requested operations.|No|No|SharePoint 2010|This rule is triggered when there is only 5% available memory left to Analysis Services. On a SharePoint application server, a SQL Server Analysis Services instance should always have a small amount of memory in reserve that is always unused. Because the server is memory-bound for the majority of its operations, the server runs best if it does not run all the way to the upper limit.<br /><br /> By default, insufficient memory warnings occur when available memory is down to 5%. You can change this value to be higher or lower by adjusting settings on the Analysis Services instance. For more information, see [Configure Power Pivot Health Rules](../../analysis-services/power-pivot-sharepoint/configure-power-pivot-health-rules.md).<br /><br /> The 5% of unused memory is calculated as a percentage of memory allocated to Analysis Services. For example, if you have 200 GB of total memory, and Analysis Services is allocated 80% of that (or 160 GB), then the 5% of unused memory is 5% of 160 GB (or 8 GB).|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: The high number of connections indicates that more servers should be deployed to handle the current load.|Yes|No|SharePoint 2010|By default, this health rule is triggered when the number of distinct user connections exceeds 100. This default value is arbitrary (it is not based on the hardware specifications of your server or on user activity) so you might raise or lower the value depending on the server capacity and user activity in your environment. For more information, see [Configure Power Pivot Health Rules](../../analysis-services/power-pivot-sharepoint/configure-power-pivot-health-rules.md).|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: The ratio of load events to connections is too high.|Yes|No|SharePoint 2013<br /><br /> SharePoint 2010|By default, this health rule is triggered when the percentage of load events to connection events exceeds 50% over the entire data collection period (by default, 4 hours). A ratio this high indicates a very high number of connections to unique workbooks, or cache reduction settings that are too aggressive (where workbooks are quickly unloaded and removed from the system, while requests for that data are still active). To avoid counting false positives, there must be at least 20 connections per 4 hour period before the ratio can be calculated. You can base this health rule on a different ratio. For more information, see [Configure Power Pivot Health Rules](../../analysis-services/power-pivot-sharepoint/configure-power-pivot-health-rules.md). For more information about configuring the cache, see [Configure Disk Space Usage &#40;Power Pivot for SharePoint&#41;](../../analysis-services/power-pivot-sharepoint/configure-disk-space-usage-power-pivot-for-sharepoint.md).|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: One or more minidump files were found in the Logs directory, indicating a program crash.|No|No|SharePoint 2013<br /><br /> SharePoint 2010|Minidump files are generated during a program crash to capture information about [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] service application state just prior to the crash. This information can be sent to Microsoft and used for troubleshooting. This rule is triggered when .dmp files are detected on the server. The rule provides a link to the file, which can be found in the \OLAP\Log folder of the [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] for SharePoint instance. Note that you cannot use a text editor to view the contents of the file. Viewing a minidump file requires that you download and install a separate debugging tool. For more information, see [Debugging Tools for Windows](/windows-hardware/drivers/debugger/).|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: Disk space is running low on the drive where [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] data is cached.|Yes|No|SharePoint 2010|By default, this health rule is triggered when disk space is less than 5% on the disk drive where the backup folder is located. For more information about setting this percentage, see [Configure Power Pivot Health Rules](../../analysis-services/power-pivot-sharepoint/configure-power-pivot-health-rules.md). For more information about disk usage, see [Configure Disk Space Usage &#40;Power Pivot for SharePoint&#41;](../../analysis-services/power-pivot-sharepoint/configure-disk-space-usage-power-pivot-for-sharepoint.md).|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: Usage data is not getting updated at the expected frequency.|Yes|No|SharePoint 2013<br /><br /> SharePoint 2010|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] for SharePoint uses the built-in usage data collection system to gather metrics about connections, data refresh, and query response times. It stores this usage data in the [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] service application database, which in turn updates a [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] workbook ([!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] Management Data.xlsx) that provides data to reports in the [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] Management Dashboard. This rule indicates that usage data is not getting moved to the [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] Management Data.xlsx file with sufficient frequency. The rule uses the timestamp on the .xlsx file as proof that the file is updated. If there are other problems in the usage data collection system that undermines the accuracy of the data, this rule will not detect it. To troubleshoot this error, check the timer jobs to verify they are running. For more information about usage data collection, see [Configure Usage Data Collection for &#40;Power Pivot for SharePoint](../../analysis-services/power-pivot-sharepoint/configure-usage-data-collection-for-power-pivot-for-sharepoint.md).|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: Midtier process account should have 'Full Read' permission on all associated SPWebApplications.|No|Yes|SharePoint 2013<br /><br /> SharePoint 2010|The [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] service application identity must have **Full Read** permissions in order to access the SharePoint content databases on behalf of users who have View Only permissions on a document.<br /><br /> To determine which account is used as the [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] service application identity, open the **Configure service accounts** page in Central Administration. Most likely, the service application runs in either the **SharePoint Web Services System** service application pool or in a dedicated application pool.<br /><br /> Although this rule provides a **Repair Automatically** option, you will get better results if you grant the permissions manually:<br /><br /> <br /><br /> 1) In Central Administration, click **Manage web applications**.<br /><br /> 2) Select a web site, and then click **User Policy**.<br /><br /> 3) Click **Add Users**.<br /><br /> 4) Select (All zones) and click **Next**.<br /><br /> 5) In Users, enter the [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] service application identity, and then click the **Full Read** checkbox. Click **6) Finish**.<br /><br /> 6) Verify the repair. In Monitoring, click **Review rule definitions**. Find and then open the [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] rule. Click **Run Now**. Go back to **Review problems and solutions** to verify the rule no longer appears.|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: Secondary Logon service (seclogon) is disabled|No|No|SharePoint 2013<br /><br /> SharePoint 2010|The Secondary Logon service is used to generate thumbnail images of [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] workbooks in the [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] Gallery. By default, the Secondary Logon service is set to manual startup. If the service is disabled, thumbnail generation will fail. Additionally, the ULS logs will contain the following error: "The error 1058 can have as a root cause the fact the Windows service "Secondary Logon" is disabled."<br /><br /> To check service configuration, use the Services console application to find Secondary Logon and change its **Startup Type** to **Manual**. If you cannot enable the service, your organization might have a group policy that disables it. Check with an administrator to determine whether this is the case.<br /><br /> After you enable the service, thumbnail or snapshot images will refresh over time. Optionally, you can force a refresh by restarting the service and opening and then resaving the property pages of a specific report. For more information, see [How to Use Power Pivot Gallery](http://go.microsoft.com/fwlink/?LinkId=246462).|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: ADOMD.NET is not installed on a standalone WFE that is configured for central admin|No|No|SharePoint 2013<br /><br /> SharePoint 2010|ADOMD.NET is an Analysis Services client library that supports connections to an Analysis Services database. In a deployment of [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] for SharePoint, ADOMD.NET provides access to the built-in reports in the [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] management dashboard in Central Administration. Built-in reports are actually [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] workbooks that contain embedded Analysis Services data. The management dashboard uses ADOMD.NET to send a connection request to the server that loads data contained in the workbook.<br /><br /> On topologies that include Central Administration running on a standalone web front end server, you must install ADOMD.NET manually if you want to view these reports in the management dashboard. For more information, see [Install ADOMD.NET on Web Front-End Servers Running Central Administration](http://msdn.microsoft.com/c2372180-e847-4cdb-b267-4befac3faf7e).|  
  
  
