---
title: "Initialization and Authorization Properties | Microsoft Docs"
description: "Initialization and authorization properties"
ms.custom: ""
ms.date: "06/14/2018"
ms.prod: sql
ms.prod_service: "database-engine, sql-database, sql-data-warehouse, pdw"
ms.reviewer: ""
ms.technology: connectivity
ms.topic: "reference"
helpviewer_keywords: 
  - "authorization [OLE DB]"
  - "properties [OLE DB]"
  - "OLE DB Driver for SQL Server, initialization properties"
  - "OLE DB Driver for SQL Server, authorization properties"
  - "initialization properties [OLE DB]"
author: pmasl
ms.author: pelopes
manager: craigg
---
# Initialization and Authorization Properties
[!INCLUDE[appliesto-ss-asdb-asdw-pdw-md](../../../includes/appliesto-ss-asdb-asdw-pdw-md.md)]

[!INCLUDE[Driver_OLEDB_Download](../../../includes/driver_oledb_download.md)]

  The OLE DB Driver for SQL Server interprets OLE DB initialization and authorization properties as follows:  
  
|Property ID|Description|  
|-----------------|-----------------|  
|DBPROP_AUTH_CACHE_AUTHINFO|The OLE DB Driver for SQL Server does not cache authentication information.<br /><br /> The OLE DB Driver for SQL Server returns DB_S_ERRORSOCCURRED on an attempt to set the property value. The *dwStatus* member of the DBPROP Structure indicates DBPROPSTATUS_NOTSUPPORTED.|  
|DBPROP_AUTH_ENCRYPT_PASSWORD|The OLE DB Driver for SQL Server uses standard [!INCLUDE[msCoName](../../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] security mechanisms to conceal passwords.<br /><br /> The OLE DB Driver for SQL Server returns DB_S_ERRORSOCCURRED on an attempt to set the property value. The *dwStatus* member of the DBPROP Structure indicates DBPROPSTATUS_NOTSUPPORTED.|  
|DBPROP_AUTH_INTEGRATED|If DBPROP_AUTH_INTEGRATED is set to a NULL pointer, a null string, or 'SSPI' VT_BSTR value, the OLE DB Driver for SQL Server uses Windows Authentication Mode to authorize user access to the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database specified by the DBPROP_INIT_DATASOURCE and DBPROP_INIT_CATALOG properties.<br /><br /> If it is set to VT_EMPTY (the default), [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] security is used. The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login and password are specified in the DBPROP_AUTH_USERID and DBPROP_AUTH_PASSWORD properties.|  
|DBPROP_AUTH_MASK_PASSWORD|The OLE DB Driver for SQL Server uses standard [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] security mechanisms to conceal passwords.<br /><br /> The OLE DB Driver for SQL Server returns DB_S_ERRORSOCCURRED on an attempt to set the property value. The *dwStatus* member of the DBPROP Structure indicates DBPROPSTATUS_NOTSUPPORTED.|  
|DBPROP_AUTH_PASSWORD|Password assigned to a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login. This property is used when [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication is selected for authorizing access to a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database.|  
|DBPROP_AUTH_PERSIST_ENCRYPTED|The OLE DB Driver for SQL Server does not encrypt authentication information when persisted.<br /><br /> The OLE DB Driver for SQL Server returns DB_S_ERRORSOCCURRED on an attempt to set the property value. The *dwStatus* member of the DBPROP Structure indicates DBPROPSTATUS_NOTSUPPORTED.|  
|DBPROP_AUTH_PERSIST_SENSITIVE_AUTHINFO|The OLE DB Driver for SQL Server persists authentication values, including an image of a password, if requested to do so. No encryption is provided.|  
|DBPROP_AUTH_USERID|[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login. This property is used when [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication is selected for authorizing access to a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database.|  
|DBPROP_INIT_ASYNCH|The OLE DB Driver for SQL Server supports asynchronous initiation.<br /><br /> Setting the DBPROPVAL_ASYNCH_INITIALIZE bit in the DBPROP_INIT_ASYNCH property causes **IDBInitialize::Initialize** to become a non-blocking call. For more information, see [Performing Asynchronous Operations](../../oledb/features/performing-asynchronous-operations.md).|  
|DBPROP_INIT_CATALOG|Name of an existing [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database to which to connect.|  
|DBPROP_INIT_DATASOURCE|Network name of a server running an instance of [!INCLUDE[msCoName](../../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]. If there are multiple instances of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] running on the computer, in order to connect to a specific instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] the value DBPROP_INIT_DATASOURCE is specified as *\\\ServerName\InstanceName*. The escape sequence \\\ is used for backslash itself.|  
|DBPROP_INIT_GENERALTIMEOUT|Indicates the number of seconds before a request, other than data source initialization and command execution, times out. A value of 0 indicates an infinite time-out. Providers that work over network connections or in distributed or transacted scenarios can support this property to advise an enlisted component to time-out in the event of a long-running request. Time-outs for data source initialization and command execution remain governed by DBPROP_INIT_TIMEOUT and DBPROP_COMMANDTIMEOUT, respectively.<br /><br /> DBPROP_INIT_GENERALTIMEOUT is read-only, and if one tries to set it the *dwstatus* error of DBPROPSTATUS_NOTSETTABLE is returned.|  
|DBPROP_INIT_HWND|The Windows handle from the calling application. A valid window handle is required for the initialization dialog box displayed when prompting for initialization properties is allowed.|  
|DBPROP_INIT_IMPERSONATION_LEVEL|The OLE DB Driver for SQL Server does not support impersonation level adjustment.<br /><br /> The OLE DB Driver for SQL Server returns DB_S_ERRORSOCCURRED on an attempt to set the property value. The *dwStatus* member of the DBPROP Structure indicates DBPROPSTATUS_NOTSUPPORTED.|  
|DBPROP_INIT_LCID|The OLE DB Driver for SQL Server validates the locale ID and returns an error if the locale ID is not supported or is not installed on the client.|  
|DBPROP_INIT_LOCATION|The OLE DB Driver for SQL Server returns DB_S_ERRORSOCCURRED on an attempt to set the property value. The *dwStatus* member of the DBPROP Structure indicates DBPROPSTATUS_NOTSUPPORTED.|  
|DBPROP_INIT_MODE|The OLE DB Driver for SQL Server returns DB_S_ERRORSOCCURRED on an attempt to set the property value. The *dwStatus* member of the DBPROP Structure indicates DBPROPSTATUS_NOTSUPPORTED.|  
|DBPROP_INIT_PROMPT|The OLE DB Driver for SQL Server supports all prompting modes for data source initialization. The OLE DB Driver for SQL Server uses DBPROMPT_NOPROMPT as its default setting for the property.|  
|DBPROP_INIT_PROTECTION_LEVEL|The OLE DB Driver for SQL Server does not support a protection level on connections to instances of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].<br /><br /> The OLE DB Driver for SQL Server returns DB_S_ERRORSOCCURRED on an attempt to set the property value. The *dwStatus* member of the DBPROP Structure indicates DBPROPSTATUS_NOTSUPPORTED.|  
|DBPROP_INIT_PROVIDERSTRING|See the OLE DB Driver for SQL Server string later in this topic.|  
|DBPROP_INIT_TIMEOUT|The OLE DB Driver for SQL Server returns an error on initialization if a connection to the instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] cannot be established within the number of seconds specified.|  
  
 In the provider-specific property set DBPROPSET_SQLSERVERDBINIT, the OLE DB Driver for SQL Server defines these additional initialization properties.  
  
|Property ID|Description|  
|-----------------|-----------------|  
|SSPROP_AUTH_ACCESS_TOKEN<sup>**1**</sup>|Type: VT_BSTR<br /><br /> R/W: Write<br /><br /> Default: VT_EMPTY<br /><br /> Description: The Access Token used in order to authneticate to Azure Active Directory|
|SSPROP_AUTH_MODE<sup>**1**</sup>|Type: VT_BSTR<br /><br /> R/W: Write<br /><br /> Default: VT_EMPTY<br /><br /> Description: Used to specify the SQL or Active Directory authentincation used. Acceptable values are:<br/><ul><li>`ActiveDirectoryPassword:` Active Directory authentication using login ID and password</li><li>`ActiveDirectoryIntegrated:` Integrated authentication to Active Directory using the currently logged-in user's account</li><li>`SqlPassword:` Authentication using username/password</li></ul>|
|SSPROP_AUTH_OLD_PASSWORD|Type: VT_BSTR<br /><br /> R/W: Write<br /><br /> Default: VT_EMPTY<br /><br /> Description: The current or expired password. For more information, see [Changing Passwords Programmatically](../../oledb/features/changing-passwords-programmatically.md).|  
|SSPROP_INIT_APPNAME|Type: VT_BSTR<br /><br /> R/W: Read/write<br /><br /> Description: The client application name.|  
|SSPROP_INIT_AUTOTRANSLATE|Type: VT_BOOL<br /><br /> R/W: Read/write<br /><br /> Default: VARIANT_TRUE<br /><br /> Description: OEM/ANSI character conversion.<br /><br /> VARIANT_TRUE: The OLE DB Driver for SQL Server translates ANSI character strings sent between the client and server by converting through Unicode to minimize problems in matching extended characters between the code pages on the client and the server:<br /><br /> Client DBTYPE_STR data sent to an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]**char**, **varchar**, or **text** variable, parameter, or column is converted from character to Unicode using the client ANSI code page (ACP) and then converted from Unicode to character using the ACP of the server.<br /><br /> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] **char**, **varchar**, or **text** data sent to a client DBTYPE_STR variable is converted from character to Unicode using the server ACP and then converted from Unicode to character using the client ACP.<br /><br /> These conversions are performed on the client by the OLE DB Driver for SQL Server. This requires that the same ACP used on the server be available on the client.<br /><br /> These settings have no effect on the conversions that occur for these transfers:<br /><br /> Unicode DBTYPE_WSTR client data sent to **char**, **varchar**, or **text** on the server.<br /><br /> **char**, **varchar**, or **text** server data sent to a Unicode DBTYPE_WSTR variable on the client.<br /><br /> ANSI DBTYPE_STR client data sent to Unicode **nchar**, **nvarchar**, or **ntext** on the server.<br /><br /> Unicode **char**, **varchar**, or **text** server data sent to an ANSI DBTYPE_STR variable on the client.<br /><br /> VARIANT_FALSE: The OLE DB Driver for SQL Server does not perform character translations.<br /><br /> The OLE DB Driver for SQL Server does not translate client ANSI character DBTYPE_STR data sent to **char**, **varchar**, or **text** variables, parameters, or columns on the server. No translation is performed on **char**, **varchar**, or **text** data sent from the server to DBTYPE_STR variables on the client.<br /><br /> If the client and the instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] are using different ACPs, extended characters can be misinterpreted.|  
|SSPROP_INIT_CURRENTLANGUAGE|Type: VT_BSTR<br /><br /> R/W: Read/write<br /><br /> Description: A [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] language name. Identifies the language used for system message selection and formatting. The language must be installed on the computer running an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] or data source initialization fails.|  
|SSPROP_INIT_DATATYPECOMPATIBILITY|Type: VT_UI2<br /><br /> R/W: Read/write<br /><br /> Default: 0<br /><br /> Description: Enables data type compatibility between [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and ActiveX Data Object (ADO) applications. If the default value of 0 is used, data type handling defaults to that used by the provider. If the value of 80 is used, data type handling uses only [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] data types. For more information, see [Using ADO with OLE DB Driver for SQL Server](../../oledb/applications/using-ado-with-oledb-driver-for-sql-server.md).|  
|SSPROP_INIT_ENCRYPT|Type: VT_BOOL<br /><br /> R/W: Read/Write<br /><br /> Default: VARIANT_FALSE<br /><br /> Description: To encrypt the data going over the network, SSPROP_INIT_ENCRYPT property is set to VARIANT_TRUE.<br /><br /> If Enable Protocol Encryption is on, encryption will always occur, regardless of the setting of SSPROP_INIT_ENCRYPT. If it is off and SSPROP_INIT_ENCRYPT is set to VARIANT_TRUE, then encryption will occur.<br /><br /> If Enable Protocol Encryption is off and SSPROP_INIT_ENCRYPT is set to VARIANT_FALSE, then no encryption occurs.|  
|SSPROP_INIT_FAILOVERPARTNER|Type: VT_BSTR<br /><br /> R/W: Read/write<br /><br /> Description: Specifies the name of the failover partner for database mirroring. It is an initialization property and can only be set before initialization. After initialization it will return the failover partner, if any, returned by the primary server.<br /><br /> This allows a smart application to cache the most recently determined backup server, but such applications should be aware that the information is only updated when the connection is first established (or reset, if pooled) and can become out of date for long term connections.<br /><br /> After making the connection, the application can query this attribute to determine the identity of the failover partner. If the primary server has no failover partner this property will return an empty string. For more information, see [Using Database Mirroring](../../oledb/features/using-database-mirroring.md).|  
|SSPROP_INIT_FILENAME|Type: VT_BSTR<br /><br /> R/W: Read/write<br /><br /> Description: Specifies the primary file name of an attachable database. This database is attached and becomes the default database for the connection. To use SSPROP_INIT_FILENAME, you must specify the name of the database as the value of the initialization property DBPROP_INIT_CATALOG. If the database name does not exist, then it looks for the primary file name specified in SSPROP_INIT_FILENAME and attaches that database with the name specified in DBPROP_INIT_CATALOG. If the database was previously attached, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] does not reattach it.|  
|SSPROP_INIT_MARSCONNECTION|Type: VT_BOOL<br /><br /> R/W: Read/write<br /><br /> Default: VARIANT_FALSE<br /><br /> Description: Specifies if Multiple Active Result Sets (MARS) are enabled for the connection. This option must be set to true before a connection is made to the database. For more information, see [Using Multiple Active Result Sets &#40;MARS&#41;](../../oledb/features/using-multiple-active-result-sets-mars.md).|  
|SSPROP_INIT_NETWORKADDRESS|Type: VT_BSTR<br /><br /> R/W: Read/write<br /><br /> Description: The network address of the server running an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] specified by the DBPROP_INIT_DATASOURCE property.|  
|SSPROP_INIT_NETWORKLIBRARY|Type: VT_BSTR<br /><br /> R/W: Read/write<br /><br /> Description: The name of the networklibrary (DLL) used to communicate with an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]. The name should not include the path or the .dll file name extension.<br /><br /> The default can be customized using the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Client Configuration Utility.<br /><br /> Note: Only TCP and Named Pipes are supported by this property. If you use this property with a prefix, you end up with a double prefix which results in an error, because the property is used to generate a prefix internally.|  
|SSPROP_INIT_PACKETSIZE|Type: VT_I4<br /><br /> R/W: Read/write<br /><br /> Description: A network packet size in bytes. The packet size property value must be between 512 and 32,767. The default OLE DB Driver for SQL Server network packet size is 4,096.|  
|SSPROP_INIT_TAGCOLUMNCOLLATION|Type: BOOL<br /><br /> R/W: Write<br /><br /> Default: FALSE<br /><br /> Description: Is used during a database update when server-side cursors are used. This property tags the data with collation information obtained from the server instead of the code page on the client. Currently, this property is used only by the distributed query process because it knows the collation of destination data and converts it correctly.|  
|SSPROP_INIT_TRUST_SERVER_CERTIFICATE|Type: VT_BOOL<br /><br /> R/W: Read/write<br /><br /> Default: VARIANT_FALSE<br /><br /> Description: Used to enable or disable server certificate validation. This property is read/write, but attempting to set it after a connection has been established will result in an error.<br /><br /> This property is ignored if the client is configured to require certificate validation. However, an application can use it together with SSPROP_INIT_ENCRYPT to guarantee that its connection to the server is encrypted, even if the client is configured not to require encryption and no certificate is provisioned on the client.<br /><br /> Client applications can query this property after a connection has been opened to determine the actual encryption and validation settings in use.<br /><br /> Note: Using encryption without certificate validation provides partial protection against packet sniffing, but it does not protect against man-in-the-middle attacks. It simply allows for encrypting the login and data sent to the server without validating the server certificate.<br /><br /> For more information, see [Using Encryption Without Validation](../../oledb/features/using-encryption-without-validation.md).|  
|SSPROP_INIT_USEPROCFORPREP|Type: VT_I4<br /><br /> R/W: Read/write<br /><br /> Default: SSPROPVAL_USEPROCFORPREP_ON<br /><br /> Description: The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] stored procedure use. Defines the use of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] temporary stored procedures to support the **ICommandPrepare** interface. This property was meaningful only when connecting to SQL Server 6.5. The property is ignored for later versions.<br /><br /> SSPROPVAL_USEPROCFORPREP_OFF: A temporary stored procedure is not created when a command is prepared.<br /><br /> SSPROPVAL_USEPROCFORPREP_ON: A temporary stored procedure is created when a command is prepared. The temporary stored procedures are dropped when the session is released.<br /><br /> SSPROPVAL_USEPROCFORPREP_ON_DROP: A temporary stored procedure is created when a command is prepared. The procedure is dropped when the command is unprepared with **ICommandPrepare::Unprepare**, when a new command is specified for the command object with **ICommandText::SetCommandText**, or when all application references to the command are released.|  
|SSPROP_INIT_WSID|Type: VT_BSTR<br /><br /> R/W: Read/write<br /><br /> Description: A string identifying the workstation.|  
  

**[1]**: When using these authentication modes, encryption is enabled by default and server certificate is validated **regardless of encryption settings**. This new behavior was introduced for improvement in security.

 In the provider-specific property set DBPROPSET_SQLSERVERDATASOURCEINFO, the OLE DB Driver for SQL Server defines the additional properties; see [Data Source Information Properties](../../oledb/ole-db-data-source-objects/data-source-information-properties.md) for more information.  
  
## The OLE DB Driver for SQL Server String  
 The OLE DB Driver for SQL Server recognizes an ODBC-like syntax in provider string property values. The provider string property is provided as the value of the OLE DB initialization property DBPROP_INIT_PROVIDERSTRING when a connection is established to the OLE DB data source. This property specifies OLE DB provider-specific connection data required to implement a connection to the OLE DB data source. Within the string, elements are delimited by using a semicolon. The final element in the string must be terminated with a semicolon. Each element consists of a keyword, an equal sign character, and the value passed on initialization. For example:  
  
```  
Server=MyServer;UID=MyUserName;  
```  
  
 With the OLE DB Driver for SQL Server, the consumer never needs to use the provider string property. The consumer can set any initialization property reflected in the provider string by using either OLE DB or OLE DB Driver for SQL Server-specific initialization properties.  
  
 For a list of the keywords available in the OLE DB Driver for SQL Server, see [Using Connection String Keywords with OLE DB Driver for SQL Server](../../oledb/applications/using-connection-string-keywords-with-oledb-driver-for-sql-server.md).  
  
## See Also  
 [Data Source Objects &#40;OLE DB&#41;](../../oledb/ole-db-data-source-objects/data-source-objects-ole-db.md)  
  
  
